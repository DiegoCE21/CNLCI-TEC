<main>
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <div class="Marco">
                    <div class="container Marco">
                        <div class="column" name="1">
                            <div style="margin-bottom: 20px;">
                                <center>
                                    <h1 class="title">Importar datos</h1>
                                </center>
                            </div>
                            @using (Html.BeginForm("null", "null", FormMethod.Post, new { @class = "Marco", enctype = "multipart/form-data", id = "formulario" }))
                            {
                                <div class="">
                                    <div class="field is-grouped is-grouped-centered">
                                        <div class="file is-primary has-name">
                                            <label class="file-label">
                                                <input type="file" name="archivo" id="archivo">
                                            </label>
                                        </div>
                                    </div>
                                    <div class="field is-grouped is-grouped-centered">
                                        <p class="control">
                                            <button type="button" class="button is-primary" onclick="Importar()">Importar</button>
                                        </p>
                                        <p class="control">
                                            <button type="reset" class="button is-danger">Limpiar</button>
                                        </p>
                                    </div>
                                </div>
                            }
                            <p>
                                <a href="~/ArchivosPI/Ingresos.xlsx" download>Plantilla .csv de ejemplo</a> para una correcta importación de datos
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="Marco">
                    <div class="container Marco">
                        <div class="column" name="2">
                            <div style="margin-bottom: 20px;">
                                <center>
                                    <h1 class="title">Copia de seguridad</h1>
                                </center>
                            </div>
                            <div class="Marco">
                                <div class="field-body has-addons-centered">
                                    <div class="field is-grouped is-grouped-centered">
                                        <div class="column ">
                                            <p class="exp">Copia de base de datos completa</p>
                                            <button type="button" class="button is-primary" onclick="Generar()">Generar</button>
                                        </div>
                                    </div>

                                </div>

                            </div>
                        </div><p style="color:white">
                            .
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="myModal" style="width: 30%; margin: auto; text-align: center; ">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-content" style="background-color:darkgray;">
                    <div class="modal-body" >
                        <div id="cuerpo"></div>

                       
                        <button class="btn btn-danger" data-dismiss="modal" onclick="cerrar()">Cerrar</button>

                    </div>
                </div>
            </div>
        </div>
    </div>

</main>
<script>

    function Generar() {
        fetch('@Url.Action("CopiaS", "Configuracion")')
            .then(response => response.json())
            .then(data => {
                console.log(data);
                abrir(data);
            })
            .catch(error => {
                console.error("Error:", error);
            });
    }

    function Importar() {
        var formulario = document.getElementById('formulario');
        var formData = new FormData(formulario);
        fetch('@Url.Action("Importar", "Configuracion")', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            console.log(data);
            abrir(data);
        })
        .catch(error => {
            console.error("Error:", error);
        });
    }

    function abrir(data) {
        document.getElementById('myModal').style.display = 'block';
        document.getElementById('cuerpo').innerHTML = ''
        var paragraph = document.createElement("p");
        paragraph.classList.add("title");
        paragraph.textContent = data;
        var cuerpoDiv = document.getElementById("cuerpo");
        cuerpoDiv.appendChild(paragraph);
    }

    function cerrar() {
        document.getElementById('myModal').style.display = 'none';
    }

</script>





